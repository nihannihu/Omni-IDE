/*---------------------------------------------------------------------------------------------
 *  Copyright (c) 2026 Mohammed Nihan (Nihan Nihu). All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75517,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let s="http://localhost:8000/api",n={async fetchPatch(e){let t=await fetch(`${s}/patch/${e}`);if(!t.ok)throw Error(`Failed to fetch patch: ${t.statusText}`);let r=await t.json();if(r.error)throw Error(r.error);return r},async applyPatch(e){let t=await fetch(`${s}/patch/${e}/apply`,{method:"POST"});if(!t.ok)throw Error(`Failed to apply patch: ${t.statusText}`);let r=await t.json();if(r.error)throw Error(r.error);return!0},async discardPatch(e){let t=await fetch(`${s}/patch/${e}/discard`,{method:"POST"});if(!t.ok)throw Error(`Failed to discard patch: ${t.statusText}`);let r=await t.json();if(r.error)throw Error(r.error);return!0},async fetchActiveSessions(){let e=await fetch(`${s}/staging/active-sessions`);if(!e.ok)throw Error(`Failed to fetch active sessions: ${e.statusText}`);return await e.json()}};function a({sessionId:e,onResolved:s}){let[a,i]=(0,r.useState)(null),[l,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(!1),[p,x]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),[g,b]=(0,r.useState)(50),[f,m]=(0,r.useState)(60),y=(0,r.useCallback)(async()=>{o(!0),x(null);try{let t=await n.fetchPatch(e);i(t)}catch(e){x(e.message||"Failed to fetch patch data.")}finally{o(!1)}},[e]);(0,r.useEffect)(()=>{e&&y()},[e,y]),(0,r.useEffect)(()=>{if(a?.status==="PENDING"&&a.created_at){let e=()=>Math.max(0,60-Math.floor((Date.now()-1e3*a.created_at)/6e4));m(e());let t=setInterval(()=>m(e()),6e4);return()=>clearInterval(t)}},[a]);let j=async()=>{if(a&&"PENDING"===a.status){c(!0),x(null);try{await n.applyPatch(e),await y(),s&&s()}catch(e){x(e.message||"Failed to apply patch.")}finally{c(!1)}}},v=async()=>{if(a&&"PENDING"===a.status){c(!0),x(null);try{await n.discardPatch(e),await y(),s&&s()}catch(e){x(e.message||"Failed to discard patch.")}finally{c(!1)}}};return l?(0,t.jsx)("div",{className:"flex items-center justify-center p-6 border rounded-md bg-gray-50 border-gray-200",children:(0,t.jsx)("p",{className:"text-gray-500 animate-pulse",children:"Loading patch comparison..."})}):p&&!a?(0,t.jsxs)("div",{className:"p-4 border rounded-md bg-red-50 border-red-200 text-red-700",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Error Loading Patch"}),(0,t.jsx)("p",{children:p})]}):a?(0,t.jsxs)("div",{className:"flex flex-col border border-gray-300 rounded-lg overflow-hidden bg-white shadow-sm mt-4 mb-4",children:[(0,t.jsxs)("div",{className:"flex flex-row justify-between items-center p-3 border-b border-gray-200 bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-800 text-sm break-all",children:["ğŸ“„ ",a.file_path.split(/[\\/]/).pop()]}),(0,t.jsxs)("span",{className:"text-xs text-gray-400 font-mono",children:["ID: ",a.session_id.split("-")[0],"..."]})]}),(0,t.jsxs)("div",{children:["PENDING"===a.status&&(0,t.jsxs)("span",{className:"mr-3 text-xs text-gray-400 font-medium tracking-wide",children:["ğŸ•’ Expires in ",f," min"]}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${(e=>{switch(e){case"PENDING":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"APPLIED":return"bg-green-100 text-green-800 border-green-200";case"DISCARDED":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800"}})(a.status)}`,children:a.status})]})]}),p&&(0,t.jsxs)("div",{className:"px-3 py-2 bg-red-100 text-red-700 text-xs font-semibold border-b border-red-200",children:["âš ï¸ ",p]}),(0,t.jsx)("div",{className:"overflow-x-auto max-h-96 w-full border-b border-gray-200 bg-gray-50 flex flex-col relative scrollbar-thin scrollbar-thumb-gray-300",children:a.diff?(0,t.jsx)("div",{className:"min-w-max py-2 flex-1",children:a.diff.split("\n").slice(0,u?g:50).map((e,r)=>{let s,n;return s="transparent",n="inherit",e.startsWith("+")&&!e.startsWith("+++")?(s="#e6ffed",n="#22863a"):e.startsWith("-")&&!e.startsWith("---")?(s="#ffeef0",n="#b31d28"):e.startsWith("@@")&&(s="#f6f8fa",n="#6a737d"),(0,t.jsx)("div",{style:{backgroundColor:s,color:n,padding:"2px 8px",fontFamily:"monospace",fontSize:"13px",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:e||" "},r)})}):(0,t.jsx)("div",{className:"p-4 text-center text-sm text-gray-500 italic",children:"Diff payload is empty or perfectly identical."})}),a.diff&&a.diff.split("\n").length>50&&(0,t.jsx)("div",{className:"bg-gray-100 border-b border-gray-200 p-2 flex justify-center w-full",children:u?a.diff.split("\n").length>g?(0,t.jsxs)("button",{onClick:()=>b(e=>e+500),className:"text-xs text-blue-600 font-semibold hover:text-blue-800 transition-colors",children:["â®Ÿ Load Next 500 Lines (",a.diff.split("\n").length-g," remaining)"]}):(0,t.jsx)("button",{onClick:()=>{h(!1),b(50)},className:"text-xs text-gray-500 font-semibold hover:text-gray-700 transition-colors",children:"â® Collapse Diff"}):(0,t.jsxs)("button",{onClick:()=>{h(!0),b(500)},className:"text-xs text-blue-600 font-semibold hover:text-blue-800 transition-colors",children:["â®Ÿ Expand Diff (",a.diff.split("\n").length-50," lines hidden)"]})}),(0,t.jsxs)("div",{className:"flex flex-row justify-end items-center p-3 space-x-3 bg-gray-100",children:[(0,t.jsx)("button",{onClick:v,disabled:"PENDING"!==a.status||d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Processing...":"Discard Patch"}),(0,t.jsx)("button",{onClick:j,disabled:"PENDING"!==a.status||d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm transition-colors",children:d?"Processing...":"Apply Patch"})]})]}):(0,t.jsx)("div",{className:"p-4 border rounded-md bg-gray-50 border-gray-200 text-gray-500",children:"No patch data available."})}let i={PENDING:{icon:"ğŸŸ¡",color:"#a3a3a3",bg:"rgba(163,163,163,0.1)",label:"Pending"},RUNNING:{icon:"ğŸ”µ",color:"#3b82f6",bg:"rgba(59,130,246,0.15)",label:"Running"},COMPLETED:{icon:"ğŸŸ¢",color:"#22c55e",bg:"rgba(34,197,94,0.12)",label:"Completed"},FAILED:{icon:"ğŸ”´",color:"#ef4444",bg:"rgba(239,68,68,0.12)",label:"Failed"},UNKNOWN:{icon:"âšª",color:"#6b7280",bg:"rgba(107,114,128,0.1)",label:"Unknown"}};function l({id:e,status:r,isCurrent:s}){let n=i[r]||i.UNKNOWN;return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"8px",background:s?n.bg:"transparent",borderLeft:s?`3px solid ${n.color}`:"3px solid transparent",transition:"all 0.25s ease",fontFamily:"'Inter', sans-serif"},children:[(0,t.jsx)("span",{style:{fontSize:"14px"},children:n.icon}),(0,t.jsx)("span",{style:{flex:1,fontSize:"13px",fontWeight:s?600:400,color:s?"#e2e8f0":"#94a3b8",textTransform:"capitalize"},children:e.replace(/_/g," ")}),(0,t.jsx)("span",{style:{fontSize:"10px",fontWeight:600,color:n.color,padding:"2px 8px",borderRadius:"10px",background:n.bg,textTransform:"uppercase",letterSpacing:"0.5px"},children:n.label})]})}function o({nodes:e,currentNode:s}){return e&&0!==e.length?(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"2px",padding:"4px 0"},children:e.map((n,a)=>(0,t.jsxs)(r.default.Fragment,{children:[(0,t.jsx)(l,{id:n.id,status:n.status,isCurrent:n.id===s}),a<e.length-1&&(0,t.jsx)("div",{style:{width:"2px",height:"14px",background:"COMPLETED"===n.status?"#22c55e":"#334155",marginLeft:"21px",transition:"background 0.3s ease"}})]},n.id))}):null}let d={graphId:"",nodes:[],currentNode:"",progress:0,isActive:!1};class c{state={...d};listeners=new Set;getState(){return this.state}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notify(){this.listeners.forEach(e=>e(this.state))}handleDagUpdate(e){if(!e||!e.nodes)return;let t=(e.nodes||[]).map(e=>({id:e.id||"unknown",status:["PENDING","RUNNING","COMPLETED","FAILED"].includes(e.status)?e.status:"UNKNOWN"}));this.state={graphId:e.graph_id||this.state.graphId||"dag",nodes:t,currentNode:e.current_node||"",progress:"number"==typeof e.progress?e.progress:this.estimateProgress(t),isActive:!0};let r=t.every(e=>"COMPLETED"===e.status),s=t.some(e=>"FAILED"===e.status);(r||s)&&setTimeout(()=>{this.state={...this.state,isActive:!1},this.notify()},2e3),this.notify()}reset(){this.state={...d},this.notify()}estimateProgress(e){return 0===e.length?0:parseFloat((e.filter(e=>"COMPLETED"===e.status).length/e.length).toFixed(2))}}let p=new c;function x(){let e=function(){let[e,t]=(0,r.useState)(p.getState());return(0,r.useEffect)(()=>p.subscribe(e=>{t({...e})}),[]),e}(),[s,n]=(0,r.useState)(!1);if(!e.isActive&&0===e.nodes.length)return null;let a=Math.round(100*e.progress);return(0,t.jsxs)("div",{style:{position:"sticky",top:"12px",zIndex:40,width:"100%",maxWidth:"320px",background:"linear-gradient(145deg, rgba(15,23,42,0.95), rgba(30,41,59,0.92))",borderRadius:"12px",border:"1px solid rgba(99,102,241,0.25)",boxShadow:"0 4px 24px rgba(0,0,0,0.35)",overflow:"hidden",transition:"opacity 0.4s ease, transform 0.3s ease",opacity:e.isActive?1:.5,fontFamily:"'Inter', sans-serif"},children:[(0,t.jsxs)("div",{onClick:()=>n(!s),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 14px",cursor:"pointer",borderBottom:s?"none":"1px solid rgba(99,102,241,0.15)",userSelect:"none"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"14px"},children:"ğŸ§­"}),(0,t.jsx)("span",{style:{fontSize:"13px",fontWeight:600,color:"#e2e8f0"},children:"Execution Timeline"})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsxs)("span",{style:{fontSize:"11px",color:"#94a3b8"},children:[a,"%"]}),(0,t.jsx)("span",{style:{fontSize:"12px",color:"#64748b",transition:"transform 0.2s"},children:s?"â–¶":"â–¼"})]})]}),(0,t.jsx)("div",{style:{width:"100%",height:"3px",background:"#1e293b"},children:(0,t.jsx)("div",{style:{height:"100%",width:`${a}%`,background:"linear-gradient(90deg, #6366f1, #22c55e)",transition:"width 0.4s ease",borderRadius:"0 2px 2px 0"}})}),!s&&(0,t.jsx)("div",{style:{padding:"8px 6px 12px 6px",maxHeight:"280px",overflowY:"auto"},children:(0,t.jsx)(o,{nodes:e.nodes,currentNode:e.currentNode})})]})}var u=e.i(27234);let h={idle:{icon:"ğŸ’¤",label:"Idle",color:"#64748b",pulse:!1},planning:{icon:"ğŸ§ ",label:"Planning",color:"#a78bfa",pulse:!0},executing:{icon:"âš¡",label:"Executing",color:"#3b82f6",pulse:!0},waiting:{icon:"â³",label:"Waiting",color:"#f59e0b",pulse:!0}};function g({status:e}){let r=h[e]||h.idle;return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",borderRadius:"8px",background:"rgba(30,41,59,0.6)"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",animation:r.pulse?"pulse 1.5s ease-in-out infinite":"none"},children:r.icon}),(0,t.jsx)("span",{style:{fontSize:"11px",fontWeight:600,color:r.color,textTransform:"uppercase",letterSpacing:"0.8px"},children:r.label}),r.pulse&&(0,t.jsx)("span",{style:{width:"6px",height:"6px",borderRadius:"50%",background:r.color,boxShadow:`0 0 6px ${r.color}`,animation:"pulse 1.5s ease-in-out infinite"}})]})}function b({isOpen:e,onClose:s,onSubmit:n}){let[a,i]=(0,r.useState)("");return e?(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("div",{style:{background:"#1E293B",padding:"16px",borderRadius:"12px",width:"320px",border:"1px solid rgba(255,255,255,0.1)",boxShadow:"0 10px 25px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",gap:"12px"},children:[(0,t.jsx)("div",{style:{fontSize:"14px",fontWeight:600,color:"#F1F5F9"},children:"Provide Feedback"}),(0,t.jsx)("div",{style:{fontSize:"12px",color:"#94A3B8"},children:"Tell us why you didn't like this action."}),(0,t.jsx)("textarea",{autoFocus:!0,value:a,onChange:e=>i(e.target.value),placeholder:"Optional comment...",style:{width:"100%",height:"80px",background:"#0F172A",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"6px",padding:"8px",color:"#F1F5F9",fontSize:"13px",resize:"none",outline:"none"}}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[(0,t.jsx)("button",{onClick:s,style:{background:"transparent",border:"1px solid rgba(255,255,255,0.2)",color:"#CBD5E1",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",cursor:"pointer"},children:"Cancel"}),(0,t.jsx)("button",{onClick:()=>n(a),style:{background:"#3B82F6",border:"none",color:"#FFFFFF",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",fontWeight:600},children:"Submit"})]})]})}):null}function f({eventId:e,module:s,context:n}){let[a,i]=(0,r.useState)("idle"),[l,o]=(0,r.useState)(!1),d=async(t,r="")=>{try{i("submitting"),fetch("http://localhost:8000/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_id:e,module:s,rating:t,comment:r||null,context:n||{}})}).catch(e=>console.error("Feedback submission error:",e)),i("success"),setTimeout(()=>i("idle"),2e3)}catch(e){console.error("Failed to submit feedback",e),i("idle")}};return"success"===a?(0,t.jsxs)("div",{style:{fontSize:"11px",color:"#22C55E",fontWeight:500,display:"flex",alignItems:"center",gap:"4px"},children:[(0,t.jsx)("span",{style:{fontSize:"12px"},children:"âœ“"})," Thanks for the feedback!"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:[(0,t.jsx)("button",{disabled:"idle"!==a,onClick:()=>{"idle"===a&&d("up")},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px 4px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s",opacity:"idle"===a?1:.5},onMouseEnter:e=>e.currentTarget.style.background="rgba(255,255,255,0.1)",onMouseLeave:e=>e.currentTarget.style.background="transparent",title:"Helpful","aria-label":"Thumbs up",children:(0,t.jsx)("span",{style:{fontSize:"14px",filter:"grayscale(1) brightness(1.5)"},children:"ğŸ‘"})}),(0,t.jsx)("div",{style:{width:"1px",height:"12px",background:"rgba(255,255,255,0.1)"}}),(0,t.jsx)("button",{disabled:"idle"!==a,onClick:()=>{"idle"===a&&o(!0)},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px 4px",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s",opacity:"idle"===a?1:.5},onMouseEnter:e=>e.currentTarget.style.background="rgba(255,255,255,0.1)",onMouseLeave:e=>e.currentTarget.style.background="transparent",title:"Not helpful","aria-label":"Thumbs down",children:(0,t.jsx)("span",{style:{fontSize:"14px",filter:"grayscale(1) brightness(1.5)"},children:"ğŸ‘"})})]}),(0,t.jsx)(b,{isOpen:l,onClose:()=>o(!1),onSubmit:e=>{o(!1),d("down",e)}})]})}function m({intent:e}){if(!e)return(0,t.jsx)("div",{style:{padding:"10px 14px",borderRadius:"8px",background:"rgba(30,41,59,0.4)",color:"#475569",fontSize:"12px",fontStyle:"italic"},children:"Waiting for user inputâ€¦"});let r=Math.round(100*e.confidence),s=r>=80?"#22c55e":r>=50?"#f59e0b":"#ef4444";return(0,t.jsxs)("div",{style:{padding:"10px 14px",borderRadius:"8px",background:"rgba(30,41,59,0.5)",border:"1px solid rgba(99,102,241,0.15)"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,t.jsxs)("span",{style:{fontSize:"13px",fontWeight:600,color:"#e2e8f0"},children:["ğŸ¯ ",e.label]}),(0,t.jsxs)("span",{style:{fontSize:"10px",fontWeight:700,color:s,padding:"2px 8px",borderRadius:"10px",background:`${s}18`},children:[r,"%"]})]}),(0,t.jsx)("div",{style:{width:"100%",height:"3px",borderRadius:"2px",background:"#1e293b",marginBottom:"6px"},children:(0,t.jsx)("div",{style:{height:"100%",width:`${r}%`,background:s,borderRadius:"2px",transition:"width 0.3s ease"}})}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("p",{style:{fontSize:"11px",color:"#94a3b8",margin:0,lineHeight:1.4,flex:1},children:e.explanation}),(0,t.jsx)("div",{style:{marginLeft:"8px"},children:(0,t.jsx)(f,{eventId:`intent-${e.timestamp}`,module:"router",context:{intent:e.label,confidence:e.confidence}})})]})]})}function y({execution:e}){if(!e)return null;let r=Math.round(100*e.progress);return(0,t.jsxs)("div",{style:{padding:"10px 14px",borderRadius:"8px",background:"rgba(30,41,59,0.5)",border:`1px solid ${e.isActive?"rgba(59,130,246,0.3)":"rgba(34,197,94,0.2)"}`},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,t.jsxs)("span",{style:{fontSize:"12px",fontWeight:600,color:"#e2e8f0"},children:["âš™ï¸ ",e.templateContext?`Workflow: ${e.templateContext.template_name}`:e.graphName]}),(0,t.jsxs)("span",{style:{fontSize:"10px",fontWeight:700,color:e.isActive?"#3b82f6":"#22c55e"},children:[e.completedNodes,"/",e.totalNodes]})]}),(0,t.jsx)("div",{style:{width:"100%",height:"4px",borderRadius:"2px",background:"#1e293b",marginBottom:"6px"},children:(0,t.jsx)("div",{style:{height:"100%",width:`${r}%`,background:e.isActive?"linear-gradient(90deg, #6366f1, #3b82f6)":"linear-gradient(90deg, #22c55e, #16a34a)",borderRadius:"2px",transition:"width 0.4s ease"}})}),e.currentNode&&e.isActive&&(0,t.jsxs)("p",{style:{fontSize:"11px",color:"#94a3b8",margin:0},children:["ğŸ”µ Running: ",(0,t.jsx)("span",{style:{color:"#cbd5e1",fontWeight:500},children:e.currentNode.replace(/_/g," ")})]}),!e.isActive&&(0,t.jsx)("p",{style:{fontSize:"11px",color:"#22c55e",margin:0},children:"âœ… Execution complete"})]})}let j={high:{icon:"ğŸ”´",color:"#ef4444"},medium:{icon:"ğŸŸ¡",color:"#f59e0b"},low:{icon:"ğŸ”µ",color:"#3b82f6"}};function v({insights:e}){return e&&0!==e.length?(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:e.map(e=>{let r=j[e.severity]||j.low;return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 10px",borderRadius:"6px",background:"rgba(30,41,59,0.35)",transition:"background 0.2s ease"},children:[(0,t.jsxs)("div",{style:{display:"flex",flex:1,alignItems:"center",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"11px"},children:r.icon}),(0,t.jsx)("span",{style:{flex:1,fontSize:"11px",color:"#cbd5e1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.title}),(0,t.jsx)("span",{style:{fontSize:"9px",color:r.color,fontWeight:600,textTransform:"uppercase",flexShrink:0,marginRight:"4px"},children:e.severity})]}),(0,t.jsx)(f,{eventId:e.id,module:"insight",context:{title:e.title}})]},e.id)})}):(0,t.jsx)("div",{style:{padding:"8px 14px",borderRadius:"8px",background:"rgba(30,41,59,0.4)",color:"#475569",fontSize:"11px",fontStyle:"italic"},children:"No insights detected yet."})}let w={router:"#A855F7",planner:"#3B82F6",insights:"#22C55E",orchestrator:"#F59E0B"};function S({explanations:e}){let[s,n]=(0,r.useState)(!1);if(!e||0===e.length)return(0,t.jsx)("div",{style:{padding:"8px 14px",borderRadius:"8px",background:"rgba(30,41,59,0.4)",color:"#475569",fontSize:"11px",fontStyle:"italic"},children:"No explanations generated yet."});let a=s?e.length:3;return(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[e.slice(0,a).map(e=>{let r=w[e.source]||"#64748B",s=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});return(0,t.jsxs)("div",{style:{padding:"8px 10px",borderRadius:"6px",background:"rgba(30,41,59,0.35)",borderLeft:`2px solid ${r}`,display:"flex",flexDirection:"column",gap:"4px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontSize:"9px",fontWeight:600,color:r,textTransform:"uppercase",letterSpacing:"0.5px"},children:e.source}),(0,t.jsx)("span",{style:{fontSize:"9px",color:"#64748B"},children:s})]}),(0,t.jsx)("span",{style:{fontSize:"11px",color:"#CBD5E1",lineHeight:1.4,marginBottom:"4px"},children:e.summary}),(0,t.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",marginTop:"2px"},children:(0,t.jsx)(f,{eventId:e.id,module:e.source,context:{summary:e.summary,reasonCode:e.reasonCode}})})]},e.id)}),e.length>3&&(0,t.jsx)("button",{onClick:()=>n(!s),style:{background:"transparent",border:"none",color:"#6366F1",fontSize:"10px",fontWeight:600,cursor:"pointer",padding:"4px 0",textAlign:"center",marginTop:"2px",textTransform:"uppercase"},children:s?"Show less":`Show ${e.length-3} more`})]})}function N({template:e,onClose:s,onSubmit:n}){let[a,i]=(0,r.useState)({});return(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("div",{style:{background:"#1E293B",padding:"20px",borderRadius:"12px",width:"360px",border:"1px solid rgba(255,255,255,0.1)",boxShadow:"0 10px 25px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",gap:"16px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{fontSize:"15px",fontWeight:600,color:"#F1F5F9"},children:["Run Workflow: ",e.name]}),(0,t.jsx)("div",{style:{fontSize:"12px",color:"#94A3B8",marginTop:"4px"},children:"Fill in the required parameters to start execution."})]}),(0,t.jsxs)("form",{onSubmit:t=>{for(let r of(t.preventDefault(),e.params))if(r.required&&!a[r.name])return void alert(`Missing required parameter: ${r.name}`);n(a)},style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.params.map(e=>(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,t.jsxs)("label",{style:{fontSize:"11px",color:"#CBD5E1",fontWeight:500,textTransform:"uppercase"},children:[e.name," ",e.required&&(0,t.jsx)("span",{style:{color:"#EF4444"},children:"*"})]}),(0,t.jsx)("input",{autoFocus:!0,type:(e.type,"text"),value:a[e.name]||"",onChange:t=>i({...a,[e.name]:t.target.value}),style:{background:"#0F172A",border:"1px solid rgba(255,255,255,0.1)",padding:"8px",borderRadius:"6px",color:"#F1F5F9",fontSize:"13px",outline:"none"},placeholder:`Enter ${e.name}...`})]},e.name)),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"8px"},children:[(0,t.jsx)("button",{type:"button",onClick:s,style:{background:"transparent",border:"1px solid rgba(255,255,255,0.2)",color:"#CBD5E1",padding:"6px 14px",borderRadius:"6px",fontSize:"12px",cursor:"pointer"},children:"Cancel"}),(0,t.jsx)("button",{type:"submit",style:{background:"#3B82F6",border:"none",color:"#FFFFFF",padding:"6px 14px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",fontWeight:600},children:"Start Execution"})]})]})]})})}function k(){let[e,s]=(0,r.useState)([]),[n,a]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{fetch("http://localhost:8000/api/templates").then(e=>e.json()).then(e=>{s(e||[]),l(!1)}).catch(e=>{console.error("Failed to fetch templates:",e),l(!1)})},[]),i)?(0,t.jsx)("div",{style:{fontSize:"12px",color:"#94a3b8"},children:"Loading workflows..."}):0===e.length?(0,t.jsx)("div",{style:{padding:"10px 14px",borderRadius:"8px",background:"rgba(30,41,59,0.4)",color:"#475569",fontSize:"12px",fontStyle:"italic"},children:"No built-in workflows found."}):(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.map(e=>(0,t.jsxs)("div",{style:{padding:"10px 14px",borderRadius:"8px",background:"rgba(30,41,59,0.5)",border:"1px solid rgba(255,255,255,0.05)",display:"flex",flexDirection:"column",gap:"6px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontSize:"13px",fontWeight:600,color:"#e2e8f0"},children:e.name}),(0,t.jsx)("button",{onClick:()=>a(e),style:{background:"#3b82f6",color:"white",border:"none",padding:"4px 10px",borderRadius:"4px",fontSize:"10px",cursor:"pointer",fontWeight:600,textTransform:"uppercase"},children:"Run"})]}),(0,t.jsx)("span",{style:{fontSize:"11px",color:"#94a3b8",lineHeight:1.4},children:e.description})]},e.id)),n&&(0,t.jsx)(N,{template:n,onClose:()=>a(null),onSubmit:e=>{n&&(fetch("http://localhost:8000/api/templates/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template_id:n.id,params:e})}).catch(e=>console.error("Template run failed:",e)),a(null))}})]})}function C(){let[e,s]=(0,r.useState)(null),[n,a]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0),o=async()=>{l(!0);try{let[e,t]=await Promise.all([fetch("http://localhost:8000/api/analytics/summary"),fetch("http://localhost:8000/api/analytics/workflows")]);s(await e.json()),a(await t.json())}catch(e){console.error("Failed to fetch analytics:",e)}finally{l(!1)}};(0,r.useEffect)(()=>{o()},[]);let d=async()=>{if(confirm("Are you sure you want to clear all analytics data? This is local-only and irreversible."))try{await fetch("http://localhost:8000/api/analytics/reset",{method:"DELETE"}),o()}catch(e){console.error("Failed to reset analytics:",e)}};return i?(0,t.jsx)("div",{style:{fontSize:"11px",color:"#94a3b8"},children:"Analyzing usage data..."}):e?(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,t.jsxs)("div",{style:{padding:"12px",borderRadius:"8px",background:"rgba(30,41,59,0.5)",border:"1px solid rgba(255,255,255,0.1)",display:"flex",flexDirection:"column",gap:"8px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",fontWeight:600,color:"#94a3b8"},children:"System Health"}),(0,t.jsxs)("span",{style:{fontSize:"18px",fontWeight:800,color:e.health_score>.7?"#22c55e":e.health_score>.4?"#eab308":"#ef4444"},children:[(100*e.health_score).toFixed(0),"%"]})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[(0,t.jsx)(I,{label:"Workflow Success",value:e.workflow_success_rate,color:"#3b82f6"}),(0,t.jsx)(I,{label:"Template Adoption",value:e.template_adoption_rate,color:"#a855f7"}),(0,t.jsx)(I,{label:"Patch Acceptance",value:e.patch_acceptance_rate,color:"#22c55e"}),(0,t.jsx)(I,{label:"Insight Acceptance",value:e.insight_acceptance_rate,color:"#14b8a6"})]})]}),(0,t.jsxs)("div",{style:{padding:"12px",borderRadius:"8px",background:"rgba(30,41,59,0.6)",border:"1px solid rgba(255,255,255,0.05)",display:"flex",flexDirection:"column",gap:"8px"},children:[(0,t.jsx)("div",{style:{fontSize:"11px",fontWeight:600,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Adoption Signals"}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",color:"#cbd5e1"},children:"Total Events"}),(0,t.jsx)("span",{style:{fontSize:"12px",fontWeight:600,color:"#f8fafc"},children:e.total_events})]}),(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,t.jsx)("span",{style:{fontSize:"12px",color:"#cbd5e1"},children:"Favorite Template"}),(0,t.jsx)("span",{style:{fontSize:"12px",fontWeight:600,color:"#3b82f6"},children:n?.most_used_template||"N/A"})]})]}),(0,t.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"4px"},children:(0,t.jsx)("button",{onClick:d,style:{background:"transparent",border:"none",color:"#475569",fontSize:"10px",cursor:"pointer",textDecoration:"underline"},children:"Clear Local Analytics"})})]}):null}function I({label:e,value:r,color:s}){return(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10px"},children:[(0,t.jsx)("span",{style:{color:"#94a3b8"},children:e}),(0,t.jsxs)("span",{style:{color:"#cbd5e1",fontWeight:500},children:[(100*r).toFixed(0),"%"]})]}),(0,t.jsx)("div",{style:{width:"100%",height:"3px",borderRadius:"1.5px",background:"rgba(255,255,255,0.05)"},children:(0,t.jsx)("div",{style:{width:`${100*r}%`,height:"100%",background:s,borderRadius:"1.5px",transition:"width 0.6s cubic-bezier(0.4, 0, 0.2, 1)"}})})]})}function E(){let s=function(){let[e,t]=(0,r.useState)(u.default.getState());return(0,r.useEffect)(()=>u.default.subscribe(e=>{t({...e})}),[]),e}(),[n,a]=(0,r.useState)(!1),[i,l]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(async()=>{try{let t=await fetch("http://localhost:8000/api/insights");if(t.ok){let r=await t.json();if(r.insights&&r.insights.length>0){let{default:t}=await e.A(58714);t.pushInsights(r.insights)}}}catch{}l(!0)})()},[]),(0,t.jsxs)("div",{id:"copilot-panel",style:{width:n?"48px":"280px",minHeight:"200px",background:"linear-gradient(180deg, rgba(15,23,42,0.97), rgba(20,27,45,0.95))",borderRadius:"14px",border:"1px solid rgba(99,102,241,0.2)",boxShadow:"0 8px 32px rgba(0,0,0,0.4)",transition:"width 0.3s ease, opacity 0.3s ease",overflow:"hidden",fontFamily:"'Inter', sans-serif",position:"fixed",top:"24px",right:"24px",zIndex:45},children:[(0,t.jsx)("div",{onClick:()=>a(!n),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:n?"12px 14px":"12px 16px",cursor:"pointer",userSelect:"none",borderBottom:n?"none":"1px solid rgba(99,102,241,0.12)"},children:n?(0,t.jsx)("span",{style:{fontSize:"16px"},children:"ğŸ¤–"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"14px"},children:"ğŸ¤–"}),(0,t.jsx)("span",{style:{fontSize:"13px",fontWeight:700,color:"#e2e8f0",letterSpacing:"0.3px"},children:"Copilot"}),(0,t.jsx)(z,{})]}),(0,t.jsx)("span",{style:{fontSize:"11px",color:"#475569",transition:"transform 0.2s"},children:n?"â—€":"â–¶"})]})}),!n&&(0,t.jsxs)("div",{style:{padding:"8px 12px 14px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(D,{text:"System Status"}),(0,t.jsx)(g,{status:s.status})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D,{text:"Detected Intent"}),(0,t.jsx)(m,{intent:s.intent})]}),s.execution&&(0,t.jsxs)("div",{children:[(0,t.jsx)(D,{text:"Execution"}),(0,t.jsx)(y,{execution:s.execution})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D,{text:"Insights"}),(0,t.jsx)(v,{insights:s.insights})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D,{text:"System Reasoning"}),(0,t.jsx)(S,{explanations:s.explanations})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D,{text:"Available Workflows"}),(0,t.jsx)(k,{})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D,{text:"Usage & Health"}),(0,t.jsx)(C,{})]})]})]})}function D({text:e}){return(0,t.jsx)("p",{style:{fontSize:"9px",fontWeight:700,color:"#475569",textTransform:"uppercase",letterSpacing:"1px",margin:"0 0 4px 2px"},children:e})}function z(){let[e,s]=(0,r.useState)(null);return((0,r.useEffect)(()=>{fetch("http://localhost:8000/api/analytics/summary").then(e=>e.json()).then(e=>s(e.health_score)).catch(()=>{})},[]),null===e)?null:(0,t.jsxs)("div",{style:{fontSize:"9px",fontWeight:900,padding:"1px 5px",borderRadius:"4px",marginLeft:"auto",marginRight:"8px",background:e>.7?"rgba(34,197,94,0.2)":"rgba(239,68,68,0.2)",color:e>.7?"#4ade80":"#f87171",border:`1px solid ${e>.7?"rgba(34,197,94,0.3)":"rgba(239,68,68,0.3)"}`,whiteSpace:"nowrap"},children:[Math.round(100*e)," HPI"]})}function F(){let[e,s]=(0,r.useState)([]),[i,l]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[c,h]=(0,r.useState)(!1),[g,b]=(0,r.useState)(""),[f,m]=(0,r.useState)(!1),[y,j]=(0,r.useState)([]),v=(0,r.useRef)(null),w=(0,r.useRef)(null),S=(0,r.useRef)(null),N=(0,r.useRef)(null),k=(0,r.useRef)(""),C=(e,t)=>{s(r=>[...r,{type:e,text:t,timestamp:new Date().toLocaleTimeString()}])};(0,r.useEffect)(()=>{let e=null,t=null;(async()=>{try{let e=await n.fetchActiveSessions();j(e)}catch(e){console.error("Failed to load active sessions",e)}})();let r=setInterval(()=>{if(k.current){let e=k.current;k.current="",s(t=>{let r=[...t];if(r.length>0){let t=r[r.length-1];if("agent_response"===t.type)return r[r.length-1]={...t,text:t.text+e},r}return[...t,{type:"agent_response",text:e,timestamp:new Date().toLocaleTimeString()}]})}},100),a=()=>{v.current=e=new WebSocket("ws://localhost:8000/ws/omni"),e.onopen=()=>{l(!0),C("info","Connected to Omni-Agent Backend"),t&&clearTimeout(t)},e.onmessage=e=>{try{let t=JSON.parse(e.data);if("transcription"===t.type)C("transcription",`User: ${t.text}`);else if("agent_response_start"===t.type)m(!0),k.current="",C("agent_response","");else if("agent_token"===t.type)k.current+=t.text;else if("agent_response_end"===t.type)m(!1);else if("dag_update"===t.type)p.handleDagUpdate(t),u.default.pushDagUpdate(t);else"copilot_event"===t.type&&("router"===t.source&&"intent"===t.event_type?u.default.pushIntent(t.payload.label,t.payload.confidence,t.payload.explanation):"insights"===t.source?u.default.pushInsights(t.payload.insights):"explainability_event"===t.event_type&&u.default.pushExplainability(t.payload))}catch(e){console.error("Failed to parse message",e)}},e.onclose=()=>{l(!1),C("error","Disconnected. Retrying in 3s..."),t||(t=setTimeout(a,3e3))},e.onerror=t=>{console.error("WebSocket error:",t),C("error","WebSocket error occurred"),e?.close()}};return a(),()=>{clearInterval(r),e&&(e.onclose=null,e.close()),t&&clearTimeout(t),w.current&&w.current.stop(),S.current&&S.current.getTracks().forEach(e=>e.stop()),N.current&&clearInterval(N.current)}},[]);let I=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e,{mimeType:"audio/webm"});w.current=t,t.ondataavailable=e=>{e.data.size>0&&v.current?.readyState===WebSocket.OPEN&&v.current.send(e.data)},t.start(),d(!0),C("info","Microphone recording started (Click Stop to send)")}catch(e){console.error("Error accessing microphone:",e),C("error","Failed to access microphone")}},D=async()=>{try{let e=await navigator.mediaDevices.getDisplayMedia({video:!0});S.current=e,h(!0),C("info","Screen sharing started");let t=e.getVideoTracks()[0],r=document.createElement("video");r.srcObject=e,r.play();let s=document.createElement("canvas"),n=s.getContext("2d");N.current=setInterval(()=>{if(v.current?.readyState===WebSocket.OPEN&&n){s.width=r.videoWidth,s.height=r.videoHeight,n.drawImage(r,0,0,s.width,s.height);let e=s.toDataURL("image/jpeg",.5);v.current.send(JSON.stringify({type:"screen_frame",image:e}))}},1e3),t.onended=()=>{z()}}catch(e){console.error("Error accessing screen:",e),C("error","Failed to share screen")}},z=()=>{S.current&&(S.current.getTracks().forEach(e=>e.stop()),h(!1),N.current&&clearInterval(N.current),C("info","Screen sharing stopped"))},F=()=>{let e=g.trim();e&&v.current&&v.current.readyState===WebSocket.OPEN&&!f&&(v.current.send(JSON.stringify({type:"text_input",text:e})),b(""))};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white font-sans p-8",children:[(0,t.jsx)(E,{}),(0,t.jsxs)("header",{className:"mb-8 flex justify-between items-center bg-gray-800 p-4 rounded-xl shadow-lg border border-gray-700",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"Omni-Agent Studio"}),(0,t.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Autonomous Digital Worker Platform"})]}),(0,t.jsxs)("div",{className:`px-4 py-2 rounded-full text-sm font-semibold flex items-center gap-2 ${i?"bg-green-500/20 text-green-400 border border-green-500/50":"bg-red-500/20 text-red-400 border border-red-500/50"}`,children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${i?"bg-green-400 animate-pulse":"bg-red-400"}`}),i?"System Online":"System Offline"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-200",children:"Sensor Controls"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("button",{onClick:o?()=>{w.current&&(w.current.stop(),w.current.stream.getTracks().forEach(e=>e.stop()),d(!1),C("info","Microphone recording stopped"))}:I,className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 ${o?"bg-red-500/20 text-red-300 border border-red-500/50 hover:bg-red-500/30":"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-500/20"}`,children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"animate-pulse",children:"â—"})," Stop Voice"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),"Enable Voice (Mic)"]})}),(0,t.jsx)("button",{onClick:c?z:D,className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 ${c?"bg-red-500/20 text-red-300 border border-red-500/50 hover:bg-red-500/30":"bg-purple-600 hover:bg-purple-500 text-white shadow-lg shadow-purple-500/20"}`,children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"animate-pulse",children:"â—"})," Stop Vision"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Enable Vision (Screen)"]})})]}),(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[(0,t.jsx)("label",{className:"text-sm text-gray-400 mb-2 block",children:"Chat with Agent"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),F())},placeholder:f?"Agent is thinking...":"Type a command...",disabled:!i||f,className:"flex-1 bg-gray-700 text-white rounded-lg px-4 py-2 text-sm border border-gray-600 focus:border-blue-500 focus:outline-none placeholder-gray-500 disabled:opacity-50"}),(0,t.jsx)("button",{onClick:F,disabled:!i||f||!g.trim(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg text-sm font-medium transition-all disabled:opacity-30 disabled:cursor-not-allowed shadow-lg shadow-blue-500/20",children:f?(0,t.jsx)("span",{className:"animate-spin inline-block",children:"â³"}):"Send"})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-xl border border-gray-700",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2 text-gray-200",children:"System Status"}),(0,t.jsxs)("div",{className:"text-sm text-gray-400 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Backend"}),(0,t.jsx)("span",{className:i?"text-green-400":"text-red-400",children:i?"Connected":"Disconnected"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Voice Module"}),(0,t.jsx)("span",{className:o?"text-blue-400":"text-gray-600",children:o?"Active":"Idle"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Vision Module"}),(0,t.jsx)("span",{className:c?"text-purple-400":"text-gray-600",children:c?"Active":"Idle"})]})]})]}),(0,t.jsx)(x,{}),y.length>0&&(0,t.jsxs)("div",{className:"bg-gray-800 p-6 rounded-2xl shadow-xl border border-blue-500/30",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-3 text-gray-200 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-400 animate-pulse"}),"Action Required"]}),(0,t.jsx)("div",{className:"space-y-3 max-h-48 overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-gray-600",children:y.map((e,r)=>(0,t.jsxs)("div",{className:"bg-gray-700/50 p-3 rounded-lg border border-gray-600 hover:border-blue-500/50 transition-colors cursor-pointer group",onClick:()=>{C("agent_response",`Restoring pending patch from queue...
Session ID: ${e.session_id}`),j(t=>t.filter(t=>t.session_id!==e.session_id))},children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsxs)("span",{className:"text-sm font-semibold text-gray-200 truncate pr-2",children:["ğŸ“„ ",e.file_path.split(/[\\/]/).pop()]}),(0,t.jsx)("span",{className:"text-xs bg-yellow-500/20 text-yellow-500 px-2 py-0.5 rounded-full font-medium",children:e.status})]}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 items-center mt-2",children:[(0,t.jsxs)("span",{children:[Math.max(0,Math.round((Date.now()-1e3*e.created_at)/6e4))," min ago"]}),(0,t.jsx)("span",{className:"text-blue-400 font-semibold opacity-0 group-hover:opacity-100 transition-opacity",children:"Review â–¸"})]})]},r))})]})]}),(0,t.jsxs)("div",{className:"lg:col-span-2 bg-black/40 p-6 rounded-2xl border border-gray-700/50 backdrop-blur-sm h-[600px] flex flex-col",children:[(0,t.jsxs)("h2",{className:"text-xl font-semibold mb-4 text-gray-200 flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),"Agent Activity Log"]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4 pr-2 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent",children:[0===e.length&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-600",children:[(0,t.jsx)("p",{children:"No activity yet."}),(0,t.jsx)("p",{className:"text-sm",children:"Start voice or vision to interact."})]}),e.map((e,r)=>{let s="agent_response"===e.type?e.text.match(/Session ID: ([a-f0-9\-]+)/):null,n=s?s[1]:null;return(0,t.jsxs)("div",{className:`p-4 rounded-xl border ${"agent_response"===e.type?"bg-blue-900/20 border-blue-500/30 ml-8":"transcription"===e.type?"bg-gray-800/50 border-gray-700 mr-8":"error"===e.type?"bg-red-900/20 border-red-500/30":"bg-gray-800/30 border-gray-700/50 text-gray-400 text-sm text-center"}`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsx)("span",{className:`text-xs font-bold uppercase tracking-wider ${"agent_response"===e.type?"text-blue-400":"transcription"===e.type?"text-green-400":"error"===e.type?"text-red-400":"text-gray-500"}`,children:"agent_response"===e.type?"Agent":"transcription"===e.type?"User":e.type.toUpperCase()}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:e.timestamp})]}),"agent_response"===e.type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"text-gray-200 whitespace-pre-wrap font-mono text-sm",children:[n?e.text.replace(s[0],""):e.text,(0,t.jsx)("span",{className:"animate-pulse inline-block w-2 h-4 bg-blue-400 ml-1"})]}),n&&(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)(a,{sessionId:n})})]}):(0,t.jsx)("div",{className:"group relative",children:(0,t.jsx)("p",{className:"text-gray-200 whitespace-pre-wrap",children:e.text})})]},r)})]})]})]})]})}e.s(["default",()=>F],75517)},45071,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function s(){let[e,s]=(0,r.useState)(null),[n,a]=(0,r.useState)(!0),[i,l]=(0,r.useState)(!1),[o,d]=(0,r.useState)(""),[c,p]=(0,r.useState)(!1),[x,u]=(0,r.useState)(!1),[h,g]=(0,r.useState)("");(0,r.useEffect)(()=>{b()},[]);let b=async()=>{try{let e=await fetch("http://localhost:8000/api/setup/status"),t=await e.json();s(t),t.has_gemini_key||l(!0)}catch(e){console.error("Failed to fetch setup status",e)}finally{a(!1)}},f=async()=>{try{let e=await fetch("http://localhost:8000/api/setup/progress"),t=await e.json();if(g(t.message),"completed"===t.status||"error"===t.status)return u(!1),"completed"===t.status&&(o?await m():setTimeout(()=>{l(!1),window.location.reload()},2e3)),!1;return!0}catch(e){return!1}},m=async()=>{try{await fetch("http://localhost:8000/api/setup/save_key",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:o})}),l(!1),window.location.reload()}catch(e){console.error(e)}},y=async e=>{u(!0),g(`Starting download for ${e}...`);try{await fetch("http://localhost:8000/api/setup/install_local",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model_name:e})});let t=setInterval(async()=>{await f()||clearInterval(t)},1e3)}catch(e){u(!1),g("Failed to start installation.")}},j=async()=>{o&&(p(!0),await m(),p(!1))};return!n&&i&&e?(0,t.jsx)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-[#1e1e1e] border border-gray-700 rounded-lg p-8 max-w-2xl w-full shadow-2xl text-gray-200",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold mb-2 text-white",children:"Smart Engine Setup"}),(0,t.jsx)("p",{className:"text-gray-400 mb-6",children:"Omni-IDE requires an AI engine config. Let's optimize for your hardware."}),(0,t.jsxs)("div",{className:"bg-[#252526] p-4 rounded mb-6 border border-gray-700 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-white",children:"ğŸ” System Scan"}),(0,t.jsxs)("p",{className:"text-sm",children:["Detected ",e.ram_gb,"GB RAM"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-semibold text-white",children:"ğŸ§  Local Daemon (Ollama)"}),(0,t.jsx)("p",{className:`text-sm ${e.ollama_running?"text-green-400":"text-red-400"}`,children:e.ollama_running?"ğŸŸ¢ Active & Ready":"ğŸ”´ Not Detected / Offline"})]})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("p",{className:"font-semibold text-white mb-2",children:"ğŸ”‘ Gemini Cloud Intelligence (Required)"}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mb-2",children:"Gemini acts as the brain for rigid tool-calling and orchestration."}),(0,t.jsx)("input",{type:"password",placeholder:"Paste Gemini API Key",className:"w-full bg-[#3c3c3c] text-white px-3 py-2 rounded border border-gray-600 focus:outline-none focus:border-blue-500 text-sm",value:o,onChange:e=>d(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:`bg-[#252526] p-6 rounded-lg border ${"CLOUD_ONLY"===e.recommendation?"border-blue-500":"border-gray-700"} flex flex-col relative overflow-hidden`,children:["CLOUD_ONLY"===e.recommendation&&(0,t.jsx)("div",{className:"absolute top-0 right-0 bg-blue-600 text-xs px-2 py-1 rounded-bl font-bold text-white",children:"Recommended"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-blue-400 mb-2",children:"âš¡ Cloud Speed"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mb-4 flex-grow",children:"Instant start. No downloads required. Zero local hardware overhead. Full speed."}),(0,t.jsx)("button",{onClick:j,disabled:c||!o,className:"w-full py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white rounded font-medium transition-colors mt-auto",children:c?"Saving...":"Use Cloud Only"})]}),(0,t.jsxs)("div",{className:`bg-[#252526] p-6 rounded-lg border ${e.recommendation.startsWith("HYBRID")?"border-green-500":"border-gray-700"} flex flex-col relative overflow-hidden`,children:[e.recommendation.startsWith("HYBRID")&&(0,t.jsx)("div",{className:"absolute top-0 right-0 bg-green-600 text-xs px-2 py-1 rounded-bl font-bold text-white",children:"Recommended"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-green-400 mb-2",children:"ğŸš€ Hybrid Power"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mb-4 flex-grow",children:"Offline-capable fallback combined with Cloud intelligence. High privacy."}),e.ollama_running?(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-1",children:["Recommended Profile (",e.ram_gb,"GB RAM):"]}),(0,t.jsx)("p",{className:"font-mono text-xs bg-[#1e1e1e] p-2 rounded border border-gray-700 text-green-300",children:"HYBRID_PRO"===e.recommendation?"qwen2.5-coder:7b (4.7 GB)":"qwen2.5-coder:3b (1.9 GB)"})]}):(0,t.jsx)("div",{className:"text-xs text-red-400 mb-4 p-2 bg-red-900/30 rounded border border-red-800",children:"âš ï¸ Ollama daemon not running. Please install Ollama on port 11434 to enable Hybrid features."}),(0,t.jsx)("div",{className:"mt-auto",children:x?(0,t.jsx)("div",{className:"w-full py-2 bg-[#3c3c3c] text-center text-gray-300 rounded text-xs font-mono truncate px-2 border border-blue-500/50",children:h||"Initializing Model..."}):(0,t.jsx)("button",{onClick:()=>y("HYBRID_PRO"===e.recommendation?"qwen2.5-coder:7b":"qwen2.5-coder:3b"),disabled:!e.ollama_running||!o,className:"w-full py-2 bg-green-700 hover:bg-green-600 disabled:opacity-50 disabled:bg-gray-700 text-white rounded font-medium transition-colors",children:"Install Hybrid"})})]})]})]})}):null}e.s(["default",()=>s])}]);