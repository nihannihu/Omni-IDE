{"version":3,"file":"notebookRenderer.test.js","sourceRoot":"","sources":["../../src/test/notebookRenderer.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport * as assert from 'assert';\r\nimport { activate } from '..';\r\nimport { RendererApi } from 'vscode-notebook-renderer';\r\nimport { IDisposable, IRichRenderContext, OutputWithAppend, RenderOptions } from '../rendererTypes';\r\nimport { JSDOM } from 'jsdom';\r\nimport { LinkDetector } from '../linkify';\r\n\r\nconst dom = new JSDOM();\r\nglobal.document = dom.window.document;\r\n\r\nsuite('Notebook builtin output renderer', () => {\r\n\r\n\tconst error = {\r\n\t\tname: 'TypeError',\r\n\t\tmessage: 'Expected type `str`, but received type `<class \\'int\\'>`',\r\n\t\tstack: '\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m' +\r\n\t\t\t'\\u001b[1;31mTypeError\\u001b[0m                                 Traceback (most recent call last)' +\r\n\t\t\t'\\u001b[1;32mc:\\\\src\\\\test\\\\ws1\\\\testing.py\\u001b[0m in \\u001b[0;36mline 2\\n\\u001b[0;32m      <a href=\\'file:///c%3A/src/test/ws1/testing.py?line=34\\'>35</a>\\u001b[0m \\u001b[39m# %%\\u001b[39;00m\\n\\u001b[1;32m----> <a href=\\'file:///c%3A/src/test/ws1/testing.py?line=35\\'>36</a>\\u001b[0m \\u001b[39mraise\\u001b[39;00m \\u001b[39mTypeError\\u001b[39;00m(\\u001b[39m\\'\\u001b[39m\\u001b[39merror = f\\u001b[39m\\u001b[39m\"\\u001b[39m\\u001b[39mExpected type `str`, but received type `\\u001b[39m\\u001b[39m{\\u001b[39m\\u001b[39mtype(name)}`\\u001b[39m\\u001b[39m\"\\u001b[39m\\u001b[39m\\'\\u001b[39m)\\n' +\r\n\t\t\t'\\u001b[1;31mTypeError\\u001b[0m: Expected type `str`, but received type `<class \\'int\\'>`\"'\r\n\t};\r\n\r\n\tconst errorMimeType = 'application/vnd.code.notebook.error';\r\n\r\n\tconst stdoutMimeType = 'application/vnd.code.notebook.stdout';\r\n\tconst stderrMimeType = 'application/vnd.code.notebook.stderr';\r\n\r\n\tconst textLikeMimeTypes = [\r\n\t\tstdoutMimeType,\r\n\t\tstderrMimeType,\r\n\t\t'text/plain'\r\n\t];\r\n\r\n\ttype optionalRenderOptions = { [k in keyof RenderOptions]?: RenderOptions[k] };\r\n\r\n\ttype handler = (e: RenderOptions) => any;\r\n\r\n\tconst settingsChangedHandlers: handler[] = [];\r\n\tfunction fireSettingsChange(options: optionalRenderOptions) {\r\n\t\tsettingsChangedHandlers.forEach((handler) => handler(options as RenderOptions));\r\n\t}\r\n\r\n\tfunction createContext(settings?: optionalRenderOptions): IRichRenderContext {\r\n\t\tsettingsChangedHandlers.length = 0;\r\n\t\treturn {\r\n\t\t\tsetState(_value: void) { },\r\n\t\t\tgetState() { return undefined; },\r\n\t\t\tasync getRenderer(_id): Promise<RendererApi | undefined> { return undefined; },\r\n\t\t\tsettings: {\r\n\t\t\t\toutputWordWrap: true,\r\n\t\t\t\toutputScrolling: true,\r\n\t\t\t\tlineLimit: 30,\r\n\t\t\t\t...settings\r\n\t\t\t} as RenderOptions,\r\n\t\t\tonDidChangeSettings(listener: handler, _thisArgs?: any, disposables?: IDisposable[]) {\r\n\t\t\t\tsettingsChangedHandlers.push(listener);\r\n\r\n\t\t\t\tconst dispose = () => {\r\n\t\t\t\t\tsettingsChangedHandlers.splice(settingsChangedHandlers.indexOf(listener), 1);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tdisposables?.push({ dispose });\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdispose\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tworkspace: {\r\n\t\t\t\tisTrusted: true\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tfunction createElement(elementType: 'div' | 'span', classes: string[]) {\r\n\t\tconst el = global.document.createElement(elementType);\r\n\t\tclasses.forEach((c) => el.classList.add(c));\r\n\t\treturn el;\r\n\t}\r\n\r\n\t// Helper to generate HTML similar to what is passed to the renderer\r\n\t// <div class=\"cell_container\" >\r\n\t//   <div class=\"output_container\" >\r\n\t//     <div class=\"output\" >\r\n\tclass OutputHtml {\r\n\t\tprivate readonly cell = createElement('div', ['cell_container']);\r\n\t\tprivate readonly firstOutput: HTMLElement;\r\n\r\n\t\tconstructor() {\r\n\t\t\tconst outputContainer = createElement('div', ['output_container']);\r\n\t\t\tconst outputElement = createElement('div', ['output']);\r\n\r\n\t\t\tthis.cell.appendChild(outputContainer);\r\n\t\t\toutputContainer.appendChild(outputElement);\r\n\r\n\t\t\tthis.firstOutput = outputElement;\r\n\t\t}\r\n\r\n\t\tpublic get cellElement() {\r\n\t\t\treturn this.cell;\r\n\t\t}\r\n\r\n\t\tpublic getFirstOuputElement() {\r\n\t\t\treturn this.firstOutput;\r\n\t\t}\r\n\r\n\t\tpublic appendOutputElement() {\r\n\t\t\tconst outputElement = createElement('div', ['output']);\r\n\t\t\tconst outputContainer = createElement('div', ['output_container']);\r\n\t\t\tthis.cell.appendChild(outputContainer);\r\n\t\t\toutputContainer.appendChild(outputElement);\r\n\r\n\t\t\treturn outputElement;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction createOutputItem(text: string, mime: string, id: string = '123', appendedText?: string): OutputWithAppend {\r\n\t\treturn {\r\n\t\t\tid: id,\r\n\t\t\tmime: mime,\r\n\t\t\tappendedText() {\r\n\t\t\t\treturn appendedText;\r\n\t\t\t},\r\n\t\t\ttext() {\r\n\t\t\t\treturn text;\r\n\t\t\t},\r\n\t\t\tblob() {\r\n\t\t\t\treturn new Blob([text], { type: mime });\r\n\t\t\t},\r\n\t\t\tjson() {\r\n\t\t\t\treturn '{ }';\r\n\t\t\t},\r\n\t\t\tdata() {\r\n\t\t\t\treturn new Uint8Array();\r\n\t\t\t},\r\n\t\t\tmetadata: {}\r\n\t\t};\r\n\t}\r\n\r\n\ttextLikeMimeTypes.forEach((mimeType) => {\r\n\t\ttest(`Render with wordwrap and scrolling for mimetype ${mimeType}`, async () => {\r\n\t\t\tconst context = createContext({ outputWordWrap: true, outputScrolling: true });\r\n\t\t\tconst renderer = await activate(context);\r\n\t\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\t\tconst outputItem = createOutputItem('content', mimeType);\r\n\t\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\r\n\t\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\t\tassert.ok(outputElement.classList.contains('remove-padding'), `Padding should be removed for scrollable outputs ${outputElement.classList}`);\r\n\t\t\tif (mimeType === 'text/plain') {\r\n\t\t\t\tassert.ok(inserted.classList.contains('word-wrap'), `Word wrap should be enabled for text/plain ${outputElement.classList}`);\r\n\t\t\t} else {\r\n\t\t\t\tassert.ok(outputElement.classList.contains('word-wrap') && inserted.classList.contains('scrollable'),\r\n\t\t\t\t\t`output content classList should contain word-wrap and scrollable ${inserted.classList}`);\r\n\t\t\t}\r\n\t\t\tassert.ok(inserted.innerHTML.indexOf('>content</') > -1, `Content was not added to output element: ${outputElement.innerHTML}`);\r\n\t\t});\r\n\r\n\t\ttest(`Render without wordwrap or scrolling for mimetype ${mimeType}`, async () => {\r\n\t\t\tconst context = createContext({ outputWordWrap: false, outputScrolling: false });\r\n\t\t\tconst renderer = await activate(context);\r\n\t\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\t\tconst outputItem = createOutputItem('content', mimeType);\r\n\t\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\r\n\t\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\t\tassert.ok(outputElement.classList.contains('remove-padding'), `Padding should be removed for non-scrollable outputs: ${outputElement.classList}`);\r\n\t\t\tassert.ok(!outputElement.classList.contains('word-wrap') && !inserted.classList.contains('scrollable'),\r\n\t\t\t\t`output content classList should not contain word-wrap and scrollable ${inserted.classList}`);\r\n\t\t\tassert.ok(inserted.innerHTML.indexOf('>content</') > -1, `Content was not added to output element: ${outputElement.innerHTML}`);\r\n\t\t});\r\n\r\n\t\ttest(`Replace content in element for mimetype ${mimeType}`, async () => {\r\n\t\t\tconst context = createContext();\r\n\t\t\tconst renderer = await activate(context);\r\n\t\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\t\tconst outputItem = createOutputItem('content', mimeType);\r\n\t\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\t\t\tconst outputItem2 = createOutputItem('replaced content', mimeType);\r\n\t\t\tawait renderer!.renderOutputItem(outputItem2, outputElement);\r\n\r\n\t\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\t\tassert.ok(inserted.innerHTML.indexOf('>content</') === -1, `Old content was not removed to output element: ${outputElement.innerHTML}`);\r\n\t\t\tassert.ok(inserted.innerHTML.indexOf('>replaced content</') !== -1, `Content was not added to output element: ${outputElement.innerHTML}`);\r\n\t\t});\r\n\r\n\t});\r\n\r\n\ttest('Append streaming output', async () => {\r\n\t\tconst context = createContext({ outputWordWrap: false, outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst outputItem = createOutputItem('content', stdoutMimeType, '123', 'ignoredAppend');\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\t\tconst outputItem2 = createOutputItem('content\\nappended', stdoutMimeType, '123', '\\nappended');\r\n\t\tawait renderer!.renderOutputItem(outputItem2, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>content</') !== -1, `Previous content should still exist: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('ignoredAppend') === -1, `Append value should not be used on first render: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>appended</') !== -1, `Content was not appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>content</') === inserted.innerHTML.lastIndexOf('>content</'), `Original content should not be duplicated: ${outputElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Appending multiple streaming outputs`, async () => {\r\n\t\tconst context = createContext({ outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputHtml = new OutputHtml();\r\n\t\tconst firstOutputElement = outputHtml.getFirstOuputElement();\r\n\t\tconst outputItem1 = createOutputItem('first stream content', stdoutMimeType, '1');\r\n\t\tconst outputItem2 = createOutputItem(JSON.stringify(error), errorMimeType, '2');\r\n\t\tconst outputItem3 = createOutputItem('second stream content', stdoutMimeType, '3');\r\n\t\tawait renderer!.renderOutputItem(outputItem1, firstOutputElement);\r\n\t\tconst secondOutputElement = outputHtml.appendOutputElement();\r\n\t\tawait renderer!.renderOutputItem(outputItem2, secondOutputElement);\r\n\t\tconst thirdOutputElement = outputHtml.appendOutputElement();\r\n\t\tawait renderer!.renderOutputItem(outputItem3, thirdOutputElement);\r\n\r\n\t\tconst appendedItem1 = createOutputItem('', stdoutMimeType, '1', ' appended1');\r\n\t\tawait renderer!.renderOutputItem(appendedItem1, firstOutputElement);\r\n\t\tconst appendedItem3 = createOutputItem('', stdoutMimeType, '3', ' appended3');\r\n\t\tawait renderer!.renderOutputItem(appendedItem3, thirdOutputElement);\r\n\r\n\t\tassert.ok(firstOutputElement.innerHTML.indexOf('>first stream content') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(firstOutputElement.innerHTML.indexOf('appended1') > -1, `Content was not appended to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(secondOutputElement.innerHTML.indexOf('>TypeError</') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(thirdOutputElement.innerHTML.indexOf('>second stream content') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(thirdOutputElement.innerHTML.indexOf('appended3') > -1, `Content was not appended to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest('Append large streaming outputs', async () => {\r\n\t\tconst context = createContext({ outputWordWrap: false, outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst lotsOfLines = new Array(4998).fill('line').join('\\n');\r\n\t\tconst firstOuput = lotsOfLines + 'expected1';\r\n\t\tconst outputItem = createOutputItem(firstOuput, stdoutMimeType, '123');\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\t\tconst appended = '\\n' + lotsOfLines + 'expectedAppend';\r\n\t\tconst outputItem2 = createOutputItem(firstOuput + appended, stdoutMimeType, '123', appended);\r\n\t\tawait renderer!.renderOutputItem(outputItem2, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted.innerHTML.indexOf('expected1') !== -1, `Last bit of previous content should still exist`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('expectedAppend') !== -1, `Content was not appended to output element`);\r\n\t});\r\n\r\n\ttest('Streaming outputs larger than the line limit are truncated', async () => {\r\n\t\tconst context = createContext({ outputWordWrap: false, outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst lotsOfLines = new Array(11000).fill('line').join('\\n');\r\n\t\tconst firstOuput = 'shouldBeTruncated' + lotsOfLines + 'expected1';\r\n\t\tconst outputItem = createOutputItem(firstOuput, stdoutMimeType, '123');\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted.innerHTML.indexOf('expected1') !== -1, `Last bit of content should exist`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('shouldBeTruncated') === -1, `Beginning content should be truncated`);\r\n\t});\r\n\r\n\ttest(`Render filepath links in text output when enabled`, async () => {\r\n\t\tLinkDetector.injectedHtmlCreator = (value: string) => value;\r\n\t\tconst context = createContext({ outputWordWrap: true, outputScrolling: true, linkifyFilePaths: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst outputItem = createOutputItem('./dir/file.txt', stdoutMimeType);\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(outputElement.innerHTML.indexOf('<a href=\"./dir/file.txt\">') !== -1, `inner HTML:\\n ${outputElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`No filepath links in text output when disabled`, async () => {\r\n\t\tLinkDetector.injectedHtmlCreator = (value: string) => value;\r\n\t\tconst context = createContext({ outputWordWrap: true, outputScrolling: true, linkifyFilePaths: false });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst outputItem = createOutputItem('./dir/file.txt', stdoutMimeType);\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(outputElement.innerHTML.indexOf('<a href=\"./dir/file.txt\">') === -1, `inner HTML:\\n ${outputElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Render with wordwrap and scrolling for error output`, async () => {\r\n\t\tLinkDetector.injectedHtmlCreator = (value: string) => value;\r\n\t\tconst context = createContext({ outputWordWrap: true, outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst outputItem = createOutputItem(JSON.stringify(error), errorMimeType);\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(outputElement.classList.contains('remove-padding'), 'Padding should be removed for scrollable outputs');\r\n\t\tassert.ok(outputElement.classList.contains('word-wrap') && inserted.classList.contains('scrollable'),\r\n\t\t\t`output content classList should contain word-wrap and scrollable ${inserted.classList}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>Expected type `str`, but received type') > -1, `Content was not added to output element:\\n ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.textContent!.indexOf('Expected type `str`, but received type `<class \\'int\\'>`') > -1, `Content was not added to output element:\\n ${outputElement.textContent}`);\r\n\t\tassert.ok(inserted.textContent!.indexOf('<a href') === -1, 'HTML links should be rendered');\r\n\t});\r\n\r\n\ttest(`Replace content in element for error output`, async () => {\r\n\t\tconst context = createContext();\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst outputItem = createOutputItem(JSON.stringify(error), errorMimeType);\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\t\tconst error2: typeof error = { ...error, message: 'new message', stack: 'replaced content' };\r\n\t\tconst outputItem2 = createOutputItem(JSON.stringify(error2), errorMimeType);\r\n\t\tawait renderer!.renderOutputItem(outputItem2, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted.innerHTML.indexOf('Expected type `str`, but received type') === -1, `Content was not removed from output element:\\n ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>replaced content</') !== -1, `Content was not added to output element:\\n ${outputElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Multiple adjacent streaming outputs should be consolidated one element`, async () => {\r\n\t\tconst context = createContext();\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputHtml = new OutputHtml();\r\n\t\tconst outputElement = outputHtml.getFirstOuputElement();\r\n\t\tconst outputItem1 = createOutputItem('first stream content', stdoutMimeType, '1');\r\n\t\tconst outputItem2 = createOutputItem('second stream content', stdoutMimeType, '2');\r\n\t\tconst outputItem3 = createOutputItem('third stream content', stderrMimeType, '3');\r\n\t\tawait renderer!.renderOutputItem(outputItem1, outputElement);\r\n\t\tawait renderer!.renderOutputItem(outputItem2, outputHtml.appendOutputElement());\r\n\t\tawait renderer!.renderOutputItem(outputItem3, outputHtml.appendOutputElement());\r\n\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>first stream content</') > -1, `Content was not added to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>second stream content</') > -1, `Content was not added to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>third stream content</') > -1, `Content was not added to output element: ${outputElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Consolidated streaming outputs should replace matching outputs correctly`, async () => {\r\n\t\tconst context = createContext({ outputScrolling: false });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputHtml = new OutputHtml();\r\n\t\tconst outputElement = outputHtml.getFirstOuputElement();\r\n\t\tconst outputItem1 = createOutputItem('first stream content', stdoutMimeType, '1');\r\n\t\tconst outputItem2 = createOutputItem('second stream content', stdoutMimeType, '2');\r\n\t\tawait renderer!.renderOutputItem(outputItem1, outputElement);\r\n\t\tconst secondOutput = outputHtml.appendOutputElement();\r\n\t\tawait renderer!.renderOutputItem(outputItem2, secondOutput);\r\n\t\tconst newOutputItem1 = createOutputItem('replaced content', stdoutMimeType, '2');\r\n\t\tawait renderer!.renderOutputItem(newOutputItem1, secondOutput);\r\n\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>first stream content</') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>replaced content</') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>second stream content</') === -1, `Content was not replaced in output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Consolidated streaming outputs should append matching outputs correctly`, async () => {\r\n\t\tconst context = createContext({ outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputHtml = new OutputHtml();\r\n\t\tconst outputElement = outputHtml.getFirstOuputElement();\r\n\t\tconst outputItem1 = createOutputItem('first stream content', stdoutMimeType, '1');\r\n\t\tconst outputItem2 = createOutputItem('second stream content', stdoutMimeType, '2');\r\n\t\tawait renderer!.renderOutputItem(outputItem1, outputElement);\r\n\t\tconst secondOutput = outputHtml.appendOutputElement();\r\n\t\tawait renderer!.renderOutputItem(outputItem2, secondOutput);\r\n\t\tconst appendingOutput = createOutputItem('', stdoutMimeType, '2', ' appended');\r\n\t\tawait renderer!.renderOutputItem(appendingOutput, secondOutput);\r\n\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>first stream content</') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>second stream content') > -1, `Second content was not added to ouptut element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('appended') > -1, `Content was not appended to ouptut element: ${outputHtml.cellElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Streaming outputs interleaved with other mime types will produce separate outputs`, async () => {\r\n\t\tconst context = createContext({ outputScrolling: false });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputHtml = new OutputHtml();\r\n\t\tconst firstOutputElement = outputHtml.getFirstOuputElement();\r\n\t\tconst outputItem1 = createOutputItem('first stream content', stdoutMimeType, '1');\r\n\t\tconst outputItem2 = createOutputItem(JSON.stringify(error), errorMimeType, '2');\r\n\t\tconst outputItem3 = createOutputItem('second stream content', stdoutMimeType, '3');\r\n\t\tawait renderer!.renderOutputItem(outputItem1, firstOutputElement);\r\n\t\tconst secondOutputElement = outputHtml.appendOutputElement();\r\n\t\tawait renderer!.renderOutputItem(outputItem2, secondOutputElement);\r\n\t\tconst thirdOutputElement = outputHtml.appendOutputElement();\r\n\t\tawait renderer!.renderOutputItem(outputItem3, thirdOutputElement);\r\n\r\n\t\tassert.ok(firstOutputElement.innerHTML.indexOf('>first stream content</') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(secondOutputElement.innerHTML.indexOf('>TypeError</') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t\tassert.ok(thirdOutputElement.innerHTML.indexOf('>second stream content</') > -1, `Content was not added to output element: ${outputHtml.cellElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Multiple adjacent streaming outputs, rerendering the first should erase the rest`, async () => {\r\n\t\tconst context = createContext();\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputHtml = new OutputHtml();\r\n\t\tconst outputElement = outputHtml.getFirstOuputElement();\r\n\t\tconst outputItem1 = createOutputItem('first stream content', stdoutMimeType, '1');\r\n\t\tconst outputItem2 = createOutputItem('second stream content', stdoutMimeType, '2');\r\n\t\tconst outputItem3 = createOutputItem('third stream content', stderrMimeType, '3');\r\n\t\tawait renderer!.renderOutputItem(outputItem1, outputElement);\r\n\t\tawait renderer!.renderOutputItem(outputItem2, outputHtml.appendOutputElement());\r\n\t\tawait renderer!.renderOutputItem(outputItem3, outputHtml.appendOutputElement());\r\n\t\tconst newOutputItem1 = createOutputItem('replaced content', stderrMimeType, '1');\r\n\t\tawait renderer!.renderOutputItem(newOutputItem1, outputElement);\r\n\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>replaced content</') > -1, `Content was not added to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>first stream content</') === -1, `Content was not cleared: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>second stream content</') === -1, `Content was not cleared: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(inserted.innerHTML.indexOf('>third stream content</') === -1, `Content was not cleared: ${outputElement.innerHTML}`);\r\n\t});\r\n\r\n\ttest(`Rendered output will wrap on settings change event`, async () => {\r\n\t\tconst context = createContext({ outputWordWrap: false, outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst outputItem = createOutputItem('content', stdoutMimeType);\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\t\tfireSettingsChange({ outputWordWrap: true, outputScrolling: true });\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(outputElement.classList.contains('word-wrap') && inserted.classList.contains('scrollable'),\r\n\t\t\t`output content classList should contain word-wrap and scrollable ${inserted.classList}`);\r\n\t});\r\n\r\n\ttest(`Settings event change listeners should not grow if output is re-rendered`, async () => {\r\n\t\tconst context = createContext({ outputWordWrap: false });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tawait renderer!.renderOutputItem(createOutputItem('content', stdoutMimeType), outputElement);\r\n\t\tconst handlerCount = settingsChangedHandlers.length;\r\n\t\tawait renderer!.renderOutputItem(createOutputItem('content', stdoutMimeType), outputElement);\r\n\r\n\t\tassert.equal(settingsChangedHandlers.length, handlerCount);\r\n\t});\r\n\r\n\tconst rawIPythonError = {\r\n\t\tname: 'NameError',\r\n\t\tmessage: `name 'x' is not defined`,\r\n\t\tstack: '\\u001b[1;31m---------------------------------------------------------------------------\\u001b[0m' +\r\n\t\t\t'\\u001b[1;31mNameError\\u001b[0m                                 Traceback (most recent call last)' +\r\n\t\t\t'Cell \\u001b[1;32mIn[2], line 1\\u001b[0m\\n\\u001b[1;32m----> 1\\u001b[0m \\u001b[43mmyfunc\\u001b[49m\\u001b[43m(\\u001b[49m\\u001b[43m)\\u001b[49m\\n' +\r\n\t\t\t'Cell \\u001b[1;32mIn[1], line 2\\u001b[0m, in \\u001b[0;36mmyfunc\\u001b[1;34m()\\u001b[0m\\n\\u001b[0;32m      1\\u001b[0m \\u001b[38;5;28;01mdef\\u001b[39;00m \\u001b[38;5;21mmyfunc\\u001b[39m():\\n\\u001b[1;32m----> 2\\u001b[0m     \\u001b[38;5;28mprint\\u001b[39m(\\u001b[43mx\\u001b[49m)\\n' +\r\n\t\t\t`\\u001b[1;31mNameError\\u001b[0m: name 'x' is not defined`\r\n\t};\r\n\r\n\ttest(`Should clean up raw IPython error stack traces`, async () => {\r\n\t\tLinkDetector.injectedHtmlCreator = (value: string) => value;\r\n\t\tconst context = createContext({ outputWordWrap: true, outputScrolling: true });\r\n\t\tconst renderer = await activate(context);\r\n\t\tassert.ok(renderer, 'Renderer not created');\r\n\r\n\t\tconst outputElement = new OutputHtml().getFirstOuputElement();\r\n\t\tconst outputItem = createOutputItem(JSON.stringify(rawIPythonError), errorMimeType);\r\n\t\tawait renderer!.renderOutputItem(outputItem, outputElement);\r\n\r\n\t\tconst inserted = outputElement.firstChild as HTMLElement;\r\n\t\tassert.ok(inserted, `nothing appended to output element: ${outputElement.innerHTML}`);\r\n\t\tassert.ok(outputElement.innerHTML.indexOf('class=\"code-background-colored\"') === -1, `inner HTML:\\n ${outputElement.innerHTML}`);\r\n\t});\r\n\r\n});\r\n\r\n"]}