{"version":3,"file":"ansi.js","sourceRoot":"","sources":["../src/ansi.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { RGBA, Color } from './color';\r\nimport { ansiColorIdentifiers } from './colorMap';\r\nimport { LinkOptions, linkify } from './linkify';\r\n\r\n\r\nexport function handleANSIOutput(text: string, linkOptions: LinkOptions): HTMLSpanElement {\r\n\r\n\tconst root: HTMLSpanElement = document.createElement('span');\r\n\tconst textLength: number = text.length;\r\n\r\n\tlet styleNames: string[] = [];\r\n\tlet customFgColor: RGBA | string | undefined;\r\n\tlet customBgColor: RGBA | string | undefined;\r\n\tlet customUnderlineColor: RGBA | string | undefined;\r\n\tlet colorsInverted: boolean = false;\r\n\tlet currentPos: number = 0;\r\n\tlet buffer: string = '';\r\n\r\n\twhile (currentPos < textLength) {\r\n\r\n\t\tlet sequenceFound: boolean = false;\r\n\r\n\t\t// Potentially an ANSI escape sequence.\r\n\t\t// See https://www.asciitable.com/ansi-escape-sequences.php & https://en.wikipedia.org/wiki/ANSI_escape_code\r\n\t\tif (text.charCodeAt(currentPos) === 27 && text.charAt(currentPos + 1) === '[') {\r\n\r\n\t\t\tconst startPos: number = currentPos;\r\n\t\t\tcurrentPos += 2; // Ignore 'Esc[' as it's in every sequence.\r\n\r\n\t\t\tlet ansiSequence: string = '';\r\n\r\n\t\t\twhile (currentPos < textLength) {\r\n\t\t\t\tconst char: string = text.charAt(currentPos);\r\n\t\t\t\tansiSequence += char;\r\n\r\n\t\t\t\tcurrentPos++;\r\n\r\n\t\t\t\t// Look for a known sequence terminating character.\r\n\t\t\t\tif (char.match(/^[ABCDHIJKfhmpsu]$/)) {\r\n\t\t\t\t\tsequenceFound = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (sequenceFound) {\r\n\r\n\t\t\t\t// Flush buffer with previous styles.\r\n\t\t\t\tappendStylizedStringToContainer(root, buffer, linkOptions, styleNames, customFgColor, customBgColor, customUnderlineColor);\r\n\r\n\t\t\t\tbuffer = '';\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t * Certain ranges that are matched here do not contain real graphics rendition sequences. For\r\n\t\t\t\t * the sake of having a simpler expression, they have been included anyway.\r\n\t\t\t\t */\r\n\t\t\t\tif (ansiSequence.match(/^(?:[34][0-8]|9[0-7]|10[0-7]|[0-9]|2[1-5,7-9]|[34]9|5[8,9]|1[0-9])(?:;[349][0-7]|10[0-7]|[013]|[245]|[34]9)?(?:;[012]?[0-9]?[0-9])*;?m$/)) {\r\n\r\n\t\t\t\t\tconst styleCodes: number[] = ansiSequence.slice(0, -1) // Remove final 'm' character.\r\n\t\t\t\t\t\t.split(';')\t\t\t\t\t\t\t\t\t\t   // Separate style codes.\r\n\t\t\t\t\t\t.filter(elem => elem !== '')\t\t\t           // Filter empty elems as '34;m' -> ['34', ''].\r\n\t\t\t\t\t\t.map(elem => parseInt(elem, 10));\t\t           // Convert to numbers.\r\n\r\n\t\t\t\t\tif (styleCodes[0] === 38 || styleCodes[0] === 48 || styleCodes[0] === 58) {\r\n\t\t\t\t\t\t// Advanced color code - can't be combined with formatting codes like simple colors can\r\n\t\t\t\t\t\t// Ignores invalid colors and additional info beyond what is necessary\r\n\t\t\t\t\t\tconst colorType = (styleCodes[0] === 38) ? 'foreground' : ((styleCodes[0] === 48) ? 'background' : 'underline');\r\n\r\n\t\t\t\t\t\tif (styleCodes[1] === 5) {\r\n\t\t\t\t\t\t\tset8BitColor(styleCodes, colorType);\r\n\t\t\t\t\t\t} else if (styleCodes[1] === 2) {\r\n\t\t\t\t\t\t\tset24BitColor(styleCodes, colorType);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetBasicFormatters(styleCodes);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Unsupported sequence so simply hide it.\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\tcurrentPos = startPos;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (sequenceFound === false) {\r\n\t\t\tbuffer += text.charAt(currentPos);\r\n\t\t\tcurrentPos++;\r\n\t\t}\r\n\t}\r\n\r\n\t// Flush remaining text buffer if not empty.\r\n\tif (buffer) {\r\n\t\tappendStylizedStringToContainer(root, buffer, linkOptions, styleNames, customFgColor, customBgColor, customUnderlineColor);\r\n\t}\r\n\r\n\treturn root;\r\n\r\n\t/**\r\n\t * Change the foreground or background color by clearing the current color\r\n\t * and adding the new one.\r\n\t * @param colorType If `'foreground'`, will change the foreground color, if\r\n\t * \t`'background'`, will change the background color, and if `'underline'`\r\n\t * will set the underline color.\r\n\t * @param color Color to change to. If `undefined` or not provided,\r\n\t * will clear current color without adding a new one.\r\n\t */\r\n\tfunction changeColor(colorType: 'foreground' | 'background' | 'underline', color?: RGBA | string | undefined): void {\r\n\t\tif (colorType === 'foreground') {\r\n\t\t\tcustomFgColor = color;\r\n\t\t} else if (colorType === 'background') {\r\n\t\t\tcustomBgColor = color;\r\n\t\t} else if (colorType === 'underline') {\r\n\t\t\tcustomUnderlineColor = color;\r\n\t\t}\r\n\t\tstyleNames = styleNames.filter(style => style !== `code-${colorType}-colored`);\r\n\t\tif (color !== undefined) {\r\n\t\t\tstyleNames.push(`code-${colorType}-colored`);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Swap foreground and background colors.  Used for color inversion.  Caller should check\r\n\t * [] flag to make sure it is appropriate to turn ON or OFF (if it is already inverted don't call\r\n\t */\r\n\tfunction reverseForegroundAndBackgroundColors(): void {\r\n\t\tconst oldFgColor: RGBA | string | undefined = customFgColor;\r\n\t\tchangeColor('foreground', customBgColor);\r\n\t\tchangeColor('background', oldFgColor);\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate and set basic ANSI formatting. Supports ON/OFF of bold, italic, underline,\r\n\t * double underline,  crossed-out/strikethrough, overline, dim, blink, rapid blink,\r\n\t * reverse/invert video, hidden, superscript, subscript and alternate font codes,\r\n\t * clearing/resetting of foreground, background and underline colors,\r\n\t * setting normal foreground and background colors, and bright foreground and\r\n\t * background colors. Not to be used for codes containing advanced colors.\r\n\t * Will ignore invalid codes.\r\n\t * @param styleCodes Array of ANSI basic styling numbers, which will be\r\n\t * applied in order. New colors and backgrounds clear old ones; new formatting\r\n\t * does not.\r\n\t * @see {@link https://en.wikipedia.org/wiki/ANSI_escape_code#SGR }\r\n\t */\r\n\tfunction setBasicFormatters(styleCodes: number[]): void {\r\n\t\tfor (const code of styleCodes) {\r\n\t\t\tswitch (code) {\r\n\t\t\t\tcase 0: {  // reset (everything)\r\n\t\t\t\t\tstyleNames = [];\r\n\t\t\t\t\tcustomFgColor = undefined;\r\n\t\t\t\t\tcustomBgColor = undefined;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 1: { // bold\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-bold`);\r\n\t\t\t\t\tstyleNames.push('code-bold');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 2: { // dim\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-dim`);\r\n\t\t\t\t\tstyleNames.push('code-dim');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 3: { // italic\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-italic`);\r\n\t\t\t\t\tstyleNames.push('code-italic');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 4: { // underline\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-underline` && style !== `code-double-underline`));\r\n\t\t\t\t\tstyleNames.push('code-underline');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 5: { // blink\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-blink`);\r\n\t\t\t\t\tstyleNames.push('code-blink');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 6: { // rapid blink\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-rapid-blink`);\r\n\t\t\t\t\tstyleNames.push('code-rapid-blink');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 7: { // invert foreground and background\r\n\t\t\t\t\tif (!colorsInverted) {\r\n\t\t\t\t\t\tcolorsInverted = true;\r\n\t\t\t\t\t\treverseForegroundAndBackgroundColors();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 8: { // hidden\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-hidden`);\r\n\t\t\t\t\tstyleNames.push('code-hidden');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 9: { // strike-through/crossed-out\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-strike-through`);\r\n\t\t\t\t\tstyleNames.push('code-strike-through');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 10: { // normal default font\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => !style.startsWith('code-font'));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 11: case 12: case 13: case 14: case 15: case 16: case 17: case 18: case 19: case 20: { // font codes (and 20 is 'blackletter' font code)\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => !style.startsWith('code-font'));\r\n\t\t\t\t\tstyleNames.push(`code-font-${code - 10}`);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 21: { // double underline\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-underline` && style !== `code-double-underline`));\r\n\t\t\t\t\tstyleNames.push('code-double-underline');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 22: { // normal intensity (bold off and dim off)\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-bold` && style !== `code-dim`));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 23: { // Neither italic or blackletter (font 10)\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-italic` && style !== `code-font-10`));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 24: { // not underlined (Neither singly nor doubly underlined)\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-underline` && style !== `code-double-underline`));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 25: { // not blinking\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-blink` && style !== `code-rapid-blink`));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 27: { // not reversed/inverted\r\n\t\t\t\t\tif (colorsInverted) {\r\n\t\t\t\t\t\tcolorsInverted = false;\r\n\t\t\t\t\t\treverseForegroundAndBackgroundColors();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 28: { // not hidden (reveal)\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-hidden`);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 29: { // not crossed-out\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-strike-through`);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 53: { // overlined\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-overline`);\r\n\t\t\t\t\tstyleNames.push('code-overline');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 55: { // not overlined\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => style !== `code-overline`);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 39: {  // default foreground color\r\n\t\t\t\t\tchangeColor('foreground', undefined);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 49: {  // default background color\r\n\t\t\t\t\tchangeColor('background', undefined);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 59: {  // default underline color\r\n\t\t\t\t\tchangeColor('underline', undefined);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 73: { // superscript\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-superscript` && style !== `code-subscript`));\r\n\t\t\t\t\tstyleNames.push('code-superscript');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 74: { // subscript\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-superscript` && style !== `code-subscript`));\r\n\t\t\t\t\tstyleNames.push('code-subscript');\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 75: { // neither superscript or subscript\r\n\t\t\t\t\tstyleNames = styleNames.filter(style => (style !== `code-superscript` && style !== `code-subscript`));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault: {\r\n\t\t\t\t\tsetBasicColor(code);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate and set styling for complicated 24-bit ANSI color codes.\r\n\t * @param styleCodes Full list of integer codes that make up the full ANSI\r\n\t * sequence, including the two defining codes and the three RGB codes.\r\n\t * @param colorType If `'foreground'`, will set foreground color, if\r\n\t * `'background'`, will set background color, and if it is `'underline'`\r\n\t * will set the underline color.\r\n\t * @see {@link https://en.wikipedia.org/wiki/ANSI_escape_code#24-bit }\r\n\t */\r\n\tfunction set24BitColor(styleCodes: number[], colorType: 'foreground' | 'background' | 'underline'): void {\r\n\t\tif (styleCodes.length >= 5 &&\r\n\t\t\tstyleCodes[2] >= 0 && styleCodes[2] <= 255 &&\r\n\t\t\tstyleCodes[3] >= 0 && styleCodes[3] <= 255 &&\r\n\t\t\tstyleCodes[4] >= 0 && styleCodes[4] <= 255) {\r\n\t\t\tconst customColor = new RGBA(styleCodes[2], styleCodes[3], styleCodes[4]);\r\n\t\t\tchangeColor(colorType, customColor);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate and set styling for advanced 8-bit ANSI color codes.\r\n\t * @param styleCodes Full list of integer codes that make up the ANSI\r\n\t * sequence, including the two defining codes and the one color code.\r\n\t * @param colorType If `'foreground'`, will set foreground color, if\r\n\t * `'background'`, will set background color and if it is `'underline'`\r\n\t * will set the underline color.\r\n\t * @see {@link https://en.wikipedia.org/wiki/ANSI_escape_code#8-bit }\r\n\t */\r\n\tfunction set8BitColor(styleCodes: number[], colorType: 'foreground' | 'background' | 'underline'): void {\r\n\t\tlet colorNumber = styleCodes[2];\r\n\t\tconst color = calcANSI8bitColor(colorNumber);\r\n\r\n\t\tif (color) {\r\n\t\t\tchangeColor(colorType, color);\r\n\t\t} else if (colorNumber >= 0 && colorNumber <= 15) {\r\n\t\t\tif (colorType === 'underline') {\r\n\t\t\t\t// for underline colors we just decode the 0-15 color number to theme color, set and return\r\n\t\t\t\tchangeColor(colorType, ansiColorIdentifiers[colorNumber].colorValue);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Need to map to one of the four basic color ranges (30-37, 90-97, 40-47, 100-107)\r\n\t\t\tcolorNumber += 30;\r\n\t\t\tif (colorNumber >= 38) {\r\n\t\t\t\t// Bright colors\r\n\t\t\t\tcolorNumber += 52;\r\n\t\t\t}\r\n\t\t\tif (colorType === 'background') {\r\n\t\t\t\tcolorNumber += 10;\r\n\t\t\t}\r\n\t\t\tsetBasicColor(colorNumber);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Calculate and set styling for basic bright and dark ANSI color codes. Uses\r\n\t * theme colors if available. Automatically distinguishes between foreground\r\n\t * and background colors; does not support color-clearing codes 39 and 49.\r\n\t * @param styleCode Integer color code on one of the following ranges:\r\n\t * [30-37, 90-97, 40-47, 100-107]. If not on one of these ranges, will do\r\n\t * nothing.\r\n\t */\r\n\tfunction setBasicColor(styleCode: number): void {\r\n\t\t// const theme = themeService.getColorTheme();\r\n\t\tlet colorType: 'foreground' | 'background' | undefined;\r\n\t\tlet colorIndex: number | undefined;\r\n\r\n\t\tif (styleCode >= 30 && styleCode <= 37) {\r\n\t\t\tcolorIndex = styleCode - 30;\r\n\t\t\tcolorType = 'foreground';\r\n\t\t} else if (styleCode >= 90 && styleCode <= 97) {\r\n\t\t\tcolorIndex = (styleCode - 90) + 8; // High-intensity (bright)\r\n\t\t\tcolorType = 'foreground';\r\n\t\t} else if (styleCode >= 40 && styleCode <= 47) {\r\n\t\t\tcolorIndex = styleCode - 40;\r\n\t\t\tcolorType = 'background';\r\n\t\t} else if (styleCode >= 100 && styleCode <= 107) {\r\n\t\t\tcolorIndex = (styleCode - 100) + 8; // High-intensity (bright)\r\n\t\t\tcolorType = 'background';\r\n\t\t}\r\n\r\n\t\tif (colorIndex !== undefined && colorType) {\r\n\t\t\tchangeColor(colorType, ansiColorIdentifiers[colorIndex]?.colorValue);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction appendStylizedStringToContainer(\r\n\troot: HTMLElement,\r\n\tstringContent: string,\r\n\tlinkOptions: LinkOptions,\r\n\tcssClasses: string[],\r\n\tcustomTextColor?: RGBA | string,\r\n\tcustomBackgroundColor?: RGBA | string,\r\n\tcustomUnderlineColor?: RGBA | string\r\n): void {\r\n\tif (!root || !stringContent) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet container = document.createElement('span');\r\n\r\n\tif (container.childElementCount === 0) {\r\n\t\t// plain text\r\n\t\tcontainer = linkify(stringContent, linkOptions, true);\r\n\t}\r\n\r\n\tcontainer.className = cssClasses.join(' ');\r\n\tif (customTextColor) {\r\n\t\tcontainer.style.color = typeof customTextColor === 'string' ? customTextColor : Color.Format.CSS.formatRGB(new Color(customTextColor));\r\n\t}\r\n\tif (customBackgroundColor) {\r\n\t\tcontainer.style.backgroundColor = typeof customBackgroundColor === 'string' ? customBackgroundColor : Color.Format.CSS.formatRGB(new Color(customBackgroundColor));\r\n\t}\r\n\tif (customUnderlineColor) {\r\n\t\tcontainer.style.textDecorationColor = typeof customUnderlineColor === 'string' ? customUnderlineColor : Color.Format.CSS.formatRGB(new Color(customUnderlineColor));\r\n\t}\r\n\troot.appendChild(container);\r\n}\r\n\r\n/**\r\n * Calculate the color from the color set defined in the ANSI 8-bit standard.\r\n * Standard and high intensity colors are not defined in the standard as specific\r\n * colors, so these and invalid colors return `undefined`.\r\n * @see {@link https://en.wikipedia.org/wiki/ANSI_escape_code#8-bit } for info.\r\n * @param colorNumber The number (ranging from 16 to 255) referring to the color\r\n * desired.\r\n */\r\nexport function calcANSI8bitColor(colorNumber: number): RGBA | undefined {\r\n\tif (colorNumber % 1 !== 0) {\r\n\t\t// Should be integer\r\n\t\treturn;\r\n\t} if (colorNumber >= 16 && colorNumber <= 231) {\r\n\t\t// Converts to one of 216 RGB colors\r\n\t\tcolorNumber -= 16;\r\n\r\n\t\tlet blue: number = colorNumber % 6;\r\n\t\tcolorNumber = (colorNumber - blue) / 6;\r\n\t\tlet green: number = colorNumber % 6;\r\n\t\tcolorNumber = (colorNumber - green) / 6;\r\n\t\tlet red: number = colorNumber;\r\n\r\n\t\t// red, green, blue now range on [0, 5], need to map to [0,255]\r\n\t\tconst convFactor: number = 255 / 5;\r\n\t\tblue = Math.round(blue * convFactor);\r\n\t\tgreen = Math.round(green * convFactor);\r\n\t\tred = Math.round(red * convFactor);\r\n\r\n\t\treturn new RGBA(red, green, blue);\r\n\t} else if (colorNumber >= 232 && colorNumber <= 255) {\r\n\t\t// Converts to a grayscale value\r\n\t\tcolorNumber -= 232;\r\n\t\tconst colorLevel: number = Math.round(colorNumber / 23 * 255);\r\n\t\treturn new RGBA(colorLevel, colorLevel, colorLevel);\r\n\t} else {\r\n\t\treturn;\r\n\t}\r\n}\r\n"]}