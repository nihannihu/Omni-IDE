{"version":3,"file":"webviewManager.js","sourceRoot":"","sources":["../src/webviewManager.ts"],"names":[],"mappings":";;;AAcA;;;GAGG;AACH;IAES,gBAAgB,CAAqB;IAC5B,SAAS,GAAG,IAAI,GAAG,EAA8B,CAAC;IAEnE;;OAEG;IACH,IAAW,aAAa,GAAmC;QAC1D,OAAO,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;IAAA,CACrF;IAEM,eAAe,CAAC,EAAU,EAAE,OAAuB,EAAE,aAAqB,EAAE,KAAyB,EAAE,IAAuB,EAAqB;QACzJ,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;YAC5B,MAAM,IAAI,KAAK,CAAC,mBAAmB,EAAE,yBAAyB,CAAC,CAAC;QACjE,CAAC;QAED,MAAM,IAAI,GAAuB;YAChC,EAAE;YACF,OAAO;YACP,aAAa;YACb,KAAK;YACL,IAAI;SACJ,CAAC;QACF,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;QAC7B,OAAO,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,EAAE,CAAC;IAAA,CACrD;IAEO,iBAAiB,CAAC,EAAU,EAAQ;QAC3C,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QAE1B,8CAA8C;QAC9C,IAAI,IAAI,CAAC,gBAAgB,KAAK,EAAE,EAAE,CAAC;YAClC,IAAI,CAAC,gBAAgB,GAAG,SAAS,CAAC;QACnC,CAAC;IAAA,CACD;IAEM,gBAAgB,CAAC,EAAU,EAAQ;QACzC,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;YAC5B,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;QAC5B,CAAC;IAAA,CACD;IAEM,UAAU,CAAC,EAAU,EAAkC;QAC7D,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;IAAA,CAC9B;IAED;;OAEG;IACI,YAAY,CAAC,EAAsB,EAAQ;QACjD,MAAM,MAAM,GAAG,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC;QAChE,MAAM,EAAE,OAAO,CAAC,WAAW,CAAC,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;IAAA,CACtD;CACD","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as vscode from 'vscode';\r\n\r\nexport interface MermaidWebviewInfo {\r\n\treadonly id: string;\r\n\treadonly webview: vscode.Webview;\r\n\treadonly mermaidSource: string;\r\n\treadonly title: string | undefined;\r\n\treadonly type: 'chat' | 'editor';\r\n}\r\n\r\n/**\r\n * Manages all mermaid webviews (both chat output renderers and editor previews).\r\n * Tracks the active webview and provides methods for interacting with webviews.\r\n */\r\nexport class MermaidWebviewManager {\r\n\r\n\tprivate _activeWebviewId: string | undefined;\r\n\tprivate readonly _webviews = new Map<string, MermaidWebviewInfo>();\r\n\r\n\t/**\r\n\t * Gets the currently active webview info.\r\n\t */\r\n\tpublic get activeWebview(): MermaidWebviewInfo | undefined {\r\n\t\treturn this._activeWebviewId ? this._webviews.get(this._activeWebviewId) : undefined;\r\n\t}\r\n\r\n\tpublic registerWebview(id: string, webview: vscode.Webview, mermaidSource: string, title: string | undefined, type: 'chat' | 'editor'): vscode.Disposable {\r\n\t\tif (this._webviews.has(id)) {\r\n\t\t\tthrow new Error(`Webview with id ${id} is already registered.`);\r\n\t\t}\r\n\r\n\t\tconst info: MermaidWebviewInfo = {\r\n\t\t\tid,\r\n\t\t\twebview,\r\n\t\t\tmermaidSource,\r\n\t\t\ttitle,\r\n\t\t\ttype\r\n\t\t};\r\n\t\tthis._webviews.set(id, info);\r\n\t\treturn { dispose: () => this.unregisterWebview(id) };\r\n\t}\r\n\r\n\tprivate unregisterWebview(id: string): void {\r\n\t\tthis._webviews.delete(id);\r\n\r\n\t\t// Clear active if this was the active webview\r\n\t\tif (this._activeWebviewId === id) {\r\n\t\t\tthis._activeWebviewId = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setActiveWebview(id: string): void {\r\n\t\tif (this._webviews.has(id)) {\r\n\t\t\tthis._activeWebviewId = id;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getWebview(id: string): MermaidWebviewInfo | undefined {\r\n\t\treturn this._webviews.get(id);\r\n\t}\r\n\r\n\t/**\r\n\t * Sends a reset pan/zoom message to a specific webview by ID.\r\n\t */\r\n\tpublic resetPanZoom(id: string | undefined): void {\r\n\t\tconst target = id ? this._webviews.get(id) : this.activeWebview;\r\n\t\ttarget?.webview.postMessage({ type: 'resetPanZoom' });\r\n\t}\r\n}\r\n"]}